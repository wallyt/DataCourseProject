# Getting and Cleaning Data Course Project
### Code book for run_analysis.R
#### Wally Thornton

## Overview
This code book covers the tidy data that is generated by run\_analysis.R, based on the UCI HAR data set. The original data set was composed of the measurements of activity trackers (Samsung Galaxy SII smartphones) worn by 30 subjects, broken into two groups, "test" and "train." For each subject, activity was classified as one of six actions: WALKING, WALKING\_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, LAYING. For each combination of subject and activity, 561 values were captured based on triaxial acceleration from the accelerometer, angular velocity from the gyroscope, time and frequency. Additional details on the raw data can be found at http://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones.

## Input and process
The data read in by run\_analysis.R are the raw data from the UCI HAR test. In general, run\_analysis does the following:
1. Merges the training and the test sets to create one data set.
2. Extracts only the measurements on the mean and standard deviation for each measurement.
3. Uses descriptive activity names to name the activities in the data set.
4. Appropriately labels the data set with descriptive variable names.
5. Creates a second, independent tidy data set with the average of each variable for each activity and each subject.

## Function walkthrough and explanation
The function run_analysis uses two packages, "plyr" and "reshape2," so to ensure that these are installed and loaded when running the code, ensurePkg tests for installation, installs them if necessary and loads them.

README.md provides the source of the raw data, which should be downloaded and unzipped in your working directory (set your working directory in line 29 before running). All the needed data are then read in using read.table() and assigned to descriptive variables. Descriptions of these data files can be found [here](http://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones).

The experiment's subjects were broken into two groups, test and train, and line 43 combines their measurements into one file. Line 44 combines the two files that list the activity code for the actions that were being performed during those measurements. Line 45 replaces the column names of the measurements table with the variable names supplied with the data. This is done for readability and better understanding.

The requirements for this project included the filtering of the 561 variables to just those that are measures of mean and standard deviation, which occurs on line 48 using a regular expression to find column names that include variants of "mean" and "std." A new table is created called filtered_data to avoid confusion with the raw data provided.

The names provided in the data set are cryptic and inconsistent, so regular expressions are now used to clean them up. *Given the lack of detail about the meaning of each variable name in the raw data, the variable names were not altered, merely cleaned up. I sought to avoid accidentally changing the meaning of any name.* Some words were not capitalized if they began the name of the variable, to preserve the raw data's camel case. This cleanup is performed on filtered_data.

The activity\_labels.txt file provided with the raw data set is essentially a lookup file for activity codes and matching names, so line 64 replaces the codes with the label (plyr's join() is used rather than merge() so that the order of the variables is preserved.) The table total\_y is then cleaned up--removing an unneeded column and renaming the activity label column--and added to the filtered_data table. This results in tidy data set that has all measurements clearly labeled with descriptive names and a separate row for each particular activity that generated those measurements, also descriptively named.

The last information to add are the subjects who took part in the experiment, which occurs on lines 72-74. Note that this new column is also descriptively named and matched up with the appropriate rows of combined\_set to create final\_set. final_set meets all requirements of a tidy data set in that there is one column for each measured variable, each different observation of that variable has its own row and all of the variables are of the same kind and are therefore in the same table.

Finally, we were required to create a second tidy data set that showed the average (mean) of each variable for each activity of each subject, which lines 78-79 accomplish. I used the reshape2 package to melt the final\_set table, using Test\_Subject and Activity as the IDs, since these are what generated the 86 values. Line 78 selects those values by subsetting based on all columns except for the first two, which are Test\_Subject and Activity. Line 79 uses dcast to both create a reshaped table and calculate the mean for each now-grouped variable. The result is a table that shows the means for 86 measurements for each combination of Test\_Subject and Activity.

## Output
The output of the function is a text file named "set_cast.txt" that is a tidy data set with the average for each variable for each activity and subject. Each measured and calculated variable has its own column, each different observation of that variable has its own row and every variable in this table is related to each other (ie, additional tables not needed).

The column headers are:
* Test_Subject, which are the integers 1-30, representing one of the 30 subjects taking part in the original experiment.
* Activity, which are the six different activities captured during the original experiment and which are enumerated in the README.md file.
* The remaining columns are the names of the measurement as defined in the original raw data but filtered per the steps outlined above. The 561 original measurements were filtered for just those measurements of mean and standard deviation, resulting in 86 variables remaining, which are named appropriately. __The variable names differ slightly from the original variable names but were modified only for readability and consistency. See the above process for details.__

The structure of set\_cast.txt is a reshaped data set that presents the means of the 86 variables mentioned above. For each combination of Test\_Subject and Activity, the mean was calculated for each of the 86 variables. For example, rows 1-6 are the means of the 86 measurements for Test\_Subject 1, for each of his/her activities (e.g., WALKING\_DOWNSTAIRS).